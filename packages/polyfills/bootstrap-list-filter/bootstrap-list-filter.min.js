(function(b){b.fn.btsListFilter=function(n,a){function p(a,c){return a.replace(/\{ *([\w_]+) *\}/g,function(a,b){return c[b]||""})}var g=this,d=b(this),f=b(n),m=d,k;a=b.extend({delay:300,minLength:1,initial:!0,casesensitive:!1,eventKey:"keyup",resetOnBlur:!0,sourceData:null,sourceTmpl:'<a class="list-group-item" href="#"><span>{title}</span></a>',sourceNode:function(b){return p(a.sourceTmpl,b)},emptyNode:function(a){return'<a class="list-group-item well" href="#"><span>No Results</span></a>'},cancelNode:function(){return'<span class="btn glyphicon glyphicon-remove form-control-feedback" aria-hidden="true"></span>'},
loadingClass:"bts-loading-list",itemClassTmp:"bts-dynamic-item",itemEl:".list-group-item",itemChild:null,itemFilter:function(d,c){c=c&&c.replace(RegExp("[({[^.$*+?\\]})]","g"),"");var e=b(d).text();return(new RegExp((a.initial?"^":"")+c,a.casesensitive?"":"i")).test(e)}},a);g.reset=function(){f.val("").trigger(a.eventKey)};if(b.isFunction(a.cancelNode)){var h=b(a.cancelNode.call(g)).hide();f.after(h);f.parents(".form-group").addClass("has-feedback");f.prev().is(".control-label")||h.css({top:0});h.css({"pointer-events":"auto"});
h.on("click",g.reset)}f.on(a.eventKey,function(a,b){var c;b=b||300;return function(){var d=this,e=arguments;clearTimeout(c);c=setTimeout(function(){a.apply(d,Array.prototype.slice.call(e))},b)}}(function(f){var c=b(this).val();a.itemEl&&(m=d.find(a.itemEl));a.itemChild&&(m=m.find(a.itemChild));var e=m.filter(function(){return a.itemFilter.call(g,this,c)}),l=m.not(e);a.itemChild&&(e=e.parents(a.itemEl),l=l.parents(a.itemEl).hide());""!==c&&c.length>=a.minLength?(e.show(),l.hide(),h.show(),"function"===
b.type(a.sourceData)?(e.hide(),l.hide(),k&&(b.isFunction(k.abort)?k.abort():b.isFunction(k.stop)&&k.stop()),d.addClass(a.loadingClass),k=a.sourceData.call(g,c,function(f){k=null;e.hide();l.hide();d.find("."+a.itemClassTmp).remove();if(f&&0!==f.length)for(var h in f)b(a.sourceNode.call(g,f[h])).addClass(a.itemClassTmp).appendTo(d);else b(a.emptyNode.call(g,c)).addClass(a.itemClassTmp).appendTo(d);d.removeClass(a.loadingClass)})):(d.find("."+a.itemClassTmp).remove(),0===e.length&&b(a.emptyNode.call(g,
c)).addClass(a.itemClassTmp).appendTo(d))):(e.show(),l.show(),h.hide(),d.find("."+a.itemClassTmp).remove())},a.delay));if(a.resetOnBlur)f.on("blur",function(a){g.reset()});return d}})(jQuery);