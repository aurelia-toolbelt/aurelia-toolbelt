(function(d,p,m,f){d.fn.password123=function(a){var b=d.data(this[0],"password123"),c=Array.prototype.slice.call(arguments,1);return b&&"string"===typeof a&&"_"!==a.charAt(0)&&b[a]?(c.unshift(this),b[a].apply(b,c)):this.map(function(b,c){return new g._init(c,a)})};var n=p.clearTimeout,q=0,g={_init:function(a,b){var c=this;c.options=d.extend({character:"&#8226;",delay:2E3,prefix:"iField",placeholder:!0,placeholderClass:"place",maskInitial:!1},b);c.encodedChar=d("<div>"+c.options.character+"</div>").text();
c.$field=c._replaceField(a).bind("textchange",function(){c._letterChange.call(c)});c.options.placeholder&&c._bindPlaceholder();c.options.maskInitial&&c.$field.keyup();return c.$field[0]},_replaceField:function(a){var b=d(a),c=b.attr("placeholder")||f,e=this.options.prefix+q++,h=b.val()||(this.options.placeholder?c||"":"");e={"class":!this.options.placeholder||c===f||h!==c&&""!==h?a.className:a.className+" "+this.options.placeholderClass,id:e,value:h,placeholder:this.options.placeholder?f:c};for(var g=
["size","tabindex","readonly","disabled","maxlength"],k=0;k<g.length;k++){var l=b.attr(g[k]);e[g[k]]=l&&-1<l?l:f}this.$hidden=d('<input type="hidden"/>').attr({name:b.attr("name"),id:a.id,"class":a.className,disabled:b.attr("disabled")}).replaceAll(b).val(h!==c?h:"");this.$oldField=b;return d('<input type="text"/>').attr(e).insertAfter(this.$hidden).data({value:b.val()||"",placeholder:c,newVal:h,password123:this})},_letterChange:function(a){a=this.$field.val();if(a.length>this.$field.data("value").length)this.$field.data("value",
this._fieldChange());else if(a.length<this.$field.data("value").length){n(this.last);var b=this.$hidden.val();if(a.length<b.length-1)b=b.substr(0,a.length);else{var c=this._getCursorPosition();b=b.length>c+1&&-1<c?b.slice(0,c).concat(b.slice(c+1)):b.slice(0,c)}this.$field.data({value:a,newVal:b});b!==this.$field.data("placeholder")&&this.$hidden.val(b)}return this},_fieldChange:function(){var a=this;n(a.last);var b=a.$field.val(),c=b.length,e=a.$hidden.val(),d=a._getCursorPosition();e=e.length>d+
1&&-1<d?e.substr(0,d-1)+b.charAt(d-1)+e.substr(d-1):e+b.charAt(c-1);a.$field.data("newVal",e);e!==a.$field.data("placeholder")&&a.$hidden.val(e);if(1<c){for(e=0;e<c-1;e++)b=b.replace(b.charAt(e),a.encodedChar);a.$field.val(b)}0<c&&(a.last=setTimeout(function(){d=a._getCursorPosition();b=a.$field.val();b=b.replace(b.charAt(c-1),a.encodedChar);a.$field.val(b).data("value",b);d!=c&&a._setCursorPosition(d)},a.options.delay));d!=c&&a._setCursorPosition(d);return b},_bindPlaceholder:function(){var a=this,
b=a.$field.data("placeholder");b!==f?a.$field.bind({"focus.password123":function(){a.$field.data("newVal")===b&&(a.$field.val("").removeClass(a.options.placeholderClass).data("newVal",""),a.$hidden.val(""))},"blur.password123":function(){b!==f&&""===a.$field.val()&&(a.$field.val(b).addClass(a.options.placeholderClass).data("newVal",b),a.options.maskInitial&&a.$field.keyup())}}):a.$field.keyup();return a},_changePlaceholder:function(a){if(a&&!this.options.placeholder)return this._bindPlaceholder();
!a&&this.options.placeholder&&this.$field.focus().unbind(".password123").blur();return this},_changePrefix:function(a){var b=this.$field.attr("id");this.$field.attr("id",b.replace(this.options.prefix,a));return this},_getCursorPosition:function(){var a=this.$field[0];if(null!=a){if(m.selection){a.focus();var b=m.selection.createRange();b.moveStart("character",-a.value.length);return b.text.length}if(a.selectionStart!==f)return a.selectionStart}return-1},_setCursorPosition:function(a){var b=this.$field[0];
null!=b&&(b.createTextRange?(b=b.createTextRange(),b.move("character",a),b.select()):b.setSelectionRange?(b.focus(),b.setSelectionRange(a,a)):b.focus())},_setOptions:function(a){var b=this;d.each(a,function(a,d){switch(a){case "placeholder":b._changePlaceholder("false"===d?!1:d);break;case "prefix":b._changePrefix(d)}b.options[a]=d});return this},destroy:function(a){var b=this.$hidden.remove().val();return this.$oldField.val(b).replaceAll(a)},option:function(a,b,c){if(!b)return d.extend({},this.options);
var e=b;if("string"===typeof b){if(c===f)return this.options[b];e={};e[b]=c}this._setOptions(e);return a}};g._init.prototype=g;d.event.special.textchange={setup:function(a,b){d(this).bind("keyup.textchange",d.event.special.textchange.handler);d(this).bind("cut.textchange paste.textchange input.textchange",d.event.special.textchange.delayedHandler)},teardown:function(a){d(this).unbind(".textchange")},handler:function(a){d.event.special.textchange.triggerIfChanged(d(this))},delayedHandler:function(a){var b=
d(this);setTimeout(function(){d.event.special.textchange.triggerIfChanged(b)},25)},triggerIfChanged:function(a){var b=a.val();if(a.val()!==a.data("lastValue")){var c=d.data(a[0],"password123");1<b.length&&-1===b.indexOf(c.encodedChar)&&(b=b.substr(0,b.length-1),a.data("value",b),c.$hidden.val(b));a.trigger("textchange",a.data("lastValue"));a.data("lastValue",a.val())}}}})(jQuery,this,this.document);